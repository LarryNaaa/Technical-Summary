

# 程序计数器(Program Counter Register)

## 1. 作用

- PC寄存器是当前线程所执行的字节码的行号指示器，用来存储指向下一条指令的地址。当CPU切换回线程时能够从正确的位置继续执行。
- 在jvm规范中，每个线程都有它自己的程序计数器，是线程私有的，生命周期与线程的生命周期保持一致。
- 程序计数器会存储当前线程正在执行的java方法的JVM指令地址；或者，如果实在执行native方法，则是未指定值（undefined）。
- 它是唯一一个在java虚拟机规范中没有规定任何OOM情况的区域，也不会出现GC垃圾回收。

## 2. 面试问题

### 2.1 使用PC寄存器存储字节码指令地址有什么用呢？/ 为什么使用PC寄存器记录当前线程的执行地址呢？

因为CPU需要不停的切换各个线程，在切换回该线程时，CPU需要知道接着从哪开始继续执行。JVM的字节码解释器就需要通过改变PC寄存器的值来明确下一条应该执行什么样的字节码指令。

### 2.2 PC寄存器为什么会设定为线程私有？

多线程在一个特定的时间段内会执行其中某一个线程的方法，CPU会不停地在不同的任务中切换，这样必然会导致经常中断或恢复，**为了能够准确地记录各个线程正在执行的当前字节码指令地址，最好的办法自然是为每一个线程都分配一个PC寄存器,**这样一来各个线程之间便可以进行独立计算，从而不会出现相互干扰的情况。

